# Лабораторная работа №5: Взаимодействие контейнеров

## Цель работы

Выполнив данную работу студент сможет управлять взаимодействием нескольких контейнеров.

## Задание

Создать php приложение на базе двух контейнеров: nginx, php-fpm.

## Подготовка

Для выполнения данной работы необходимо иметь установленный на компьютере [Docker](https://www.docker.com/).

Для выполнения работы необходимо иметь опыт выполнения лабораторной работы №3.

## Выполнение

Создайте репозиторий `containers05` и скопируйте его себе на компьютер.

В директории `containers05` создайте директорию `mounts/site`. В данную директорию перепишите сайт на php, созданный в рамках предмета по php.

Создайте файл `.gitignore` в корне проекта и добавьте в него строки:

```gitignore
# Ignore files and directories
mounts/site/*
```

Создайте в директории `containers05` файл `nginx/default.conf` со следующим содержимым:

```nginx
server {
    listen 80;
    server_name _;
    root /var/www/html;
    index index.php;
    location / {
        try_files $uri $uri/ /index.php?$args;
    }
    location ~ \.php$ {
        fastcgi_pass backend:9000;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
        include fastcgi_params;
    }
}
```

## Запуск и тестирование

Создайте сеть `internal` для контейнеров.

Создайте контейнер `backend` со следующими свойствами:

- на базе образа `php:7.4-fpm`;
- к контейнеру примонтирована директория `mounts/site` в `/var/www/html`;
- работает в сети `internal`.

Создайте контейнер `frontend` со следующими свойствами:

- на базе образа `nginx:1.23-alpine`;
- с примонтированной директорией `mounts/site` в `/var/www/html`;
- с примонтированным файлом `nginx/default.conf` в `/etc/nginx/conf.d/default.conf`;
- порт 80 контейнера проброшен на порт 80 хоста;
- работает в сети `internal`.

Проверьте работу сайта в браузере, перейдя по адресу `http://localhost`. Если отображается базовая страница `nginx`, то перегрузите страницу.

## Создание отчета

Создайте в папке `containers05` файл `README.md` который содержать пошаговое выполнение проекта. Описание проекта должно содержать:

1. Название лабораторной работы.
2. Цель работы.
3. Задание.
4. Описание выполнения работы с ответами на вопросы.
5. Выводы.

Ответьте на вопросы:

1. Каким образом в данном примере контейнеры могут взаимодействовать друг с другом?
2. Как видят контейнеры друг друга в рамках сети `internal`?
3. Почему необходимо было переопределять конфигурацию `nginx`?

Выложите проект на GitHub.

## Представление

При представлении ответа прикрепите к заданию ссылку на репозиторий.

## Оценивание
